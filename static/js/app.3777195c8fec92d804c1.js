webpackJsonp([1],{NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),o=n("j5iW"),i=n("8OAG"),s=(n("wj+B"),n("mbRB"),n("XtQa"),n("XDfE"),{render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",[n("f7-navbar",[n("f7-nav-left",[n("f7-link",{attrs:{"icon-if-ios":"f7:menu","icon-if-md":"material:menu","panel-open":"left"}})],1),t._v(" "),n("f7-nav-title",[t._v("智能小车")])],1),t._v(" "),n("f7-list",[n("f7-list-item",{attrs:{link:"/car/bluetooth/","panel-close":"",title:"蓝牙小车"}})],1),t._v(" "),n("f7-block",{attrs:{strong:""}},[n("p",[t._v("蓝牙小车上位机, 基于 cordova + framework7 + vue.js开发")]),t._v(" "),n("p",[t._v("蓝牙小车下位机使用arduino来制作")]),t._v(" "),n("p",[t._v("源代码在: https://github.com/chengxg/small-car")])])],1)},staticRenderFns:[]}),l=n("VU/8")({},s,!1,null,null,null).exports,r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",[n("f7-navbar",{attrs:{title:"关于","back-link":"Back"}}),t._v(" "),n("f7-block-title",[t._v("智能小车控制APP")]),t._v(" "),n("f7-block",{attrs:{strong:""}},[n("p",[t._v("简介: 【智能小车控制APP】实现了蓝牙遥控小车的模式选择，手动遥控，自动寻迹参数调试等功能。")]),t._v(" "),n("p",[t._v("当前版本: 0.1.0")]),t._v(" "),n("p",[t._v("版权所有: ©2018-2019 程小刚")])])],1)},staticRenderFns:[]},c=n("VU/8")({},r,!1,null,null,null).exports,u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("f7-page",[e("f7-navbar",{attrs:{title:"Not found","back-link":"Back"}}),this._v(" "),e("f7-block",{attrs:{strong:""}},[e("p",[this._v("Sorry")]),this._v(" "),e("p",[this._v("Requested content not found.")])])],1)},staticRenderFns:[]},v=n("VU/8")({},u,!1,null,null,null).exports,d=n("//Fk"),h=n.n(d),f={pairedDevices:[],newDevices:[],receiveDataStr:"",sendData:"",errMsg:"",successMsg:"",connectedDevice:null,connectingDevice:null,isFindding:!1,enableBluetooth:!1,bufferSize:16,receiveDataCallback:null,sendDataFunc:function(t){if(this.enableBluetooth&&t&&this.connectedDevice){var e=this;cxg.bluetoothSerial.sendData(function(t){},function(t){e.errMsg=t},t)}}},m=n("pFYg"),g=n.n(m),p={name:"BluetoothManage",data:function(){return f},created:function(){},mounted:function(){var t=this;setTimeout(function(){t.init()},1e3)},computed:{},props:{show:{type:Boolean,default:!0},beforeClose:Function},watch:{successMsg:function(){this.$f7.toast.create({text:this.successMsg,position:"center",closeTimeout:2e3}).open()},errMsg:function(){this.$f7.toast.create({text:this.errMsg,position:"center",closeTimeout:3e3}).open()}},methods:{init:function(){"undefined"!=typeof cxg&&void 0!==cxg.bluetoothSerial?(this.getBluetoothStatus(),this.getPairedDevices(),this.listenBluetoothStatus()):this.errMsg="蓝牙插件未发现, 请在app中打开"},getBluetoothStatus:function(){var t=this;cxg.bluetoothSerial.getBluetoothStatus(function(e){t.enableBluetooth="true"==e},function(e){t.errMsg=e})},listenBluetoothStatus:function(){var t=this;cxg.bluetoothSerial.listenBluetoothStatus(function(e){switch(e){case"STATE_ON":t.enableBluetooth=!0,t.getPairedDevices();break;case"STATE_OFF":t.enableBluetooth=!1}},function(e){t.errMsg=e})},turnOnOrOffBluetooth:function(t,e){var n=t.target.checked;this.enableBluetooth!==n&&(this.enableBluetooth=n,n?this.turnOnBluetooth():this.turnOffBluetooth())},turnOnBluetooth:function(){var t=this;cxg.bluetoothSerial.turnOnBluetooth(function(e){t.successMsg=e},function(e){t.errMsg=e,setTimeout(function(){t.enableBluetooth=!1},100)})},turnOffBluetooth:function(){var t=this;cxg.bluetoothSerial.turnOffBluetooth(function(e){t.successMsg=e,t.isFindding=!1},function(e){t.errMsg=e,setTimeout(function(){t.enableBluetooth=!0},100)})},getPairedDevices:function(){var t=this;cxg.bluetoothSerial.getPairedDevices(function(e){e.forEach(function(t){}),t.pairedDevices=e},function(e){t.errMsg=e})},findDevices:function(){var t=this;this.enableBluetooth&&(this.isFindding||(this.isFindding=!0,t.newDevices=[],cxg.bluetoothSerial.findingNewDevices(function(e){"string"==typeof e&&(t.isFindding=!1),"object"===(void 0===e?"undefined":g()(e))&&t.newDevices.push(e)},function(e){t.errMsg=e,t.isFindding=!1})))},connDevice:function(t){var e=this;this.enableBluetooth&&(t?this.connectedDevice!==t?(e.connectingDevice=t,cxg.bluetoothSerial.connDevice(function(n){e.connectingDevice=null,e.successMsg=n,e.readData(),e.connectedDevice=t},function(t){e.errMsg=t,e.connectingDevice=null},t.address)):e.disConnDevice():e.errMsg="请输入蓝牙设备地址!")},disConnDevice:function(){if(this.connectedDevice){var t=this;t.connectingDevice=t.connectedDevice,cxg.bluetoothSerial.disConnDevice(function(e){t.connectedDevice=null,t.connectingDevice=null},function(e){t.errMsg=e,t.connectingDevice=null})}},readData:function(){if(this.enableBluetooth){var t=this;cxg.bluetoothSerial.readData(function(t){f.receiveDataCallback&&f.receiveDataCallback(t),f.receiveDataStr=t},function(e){t.connectedDevice=null,t.errMsg=e},this.bufferSize)}}},components:{}},B={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",[n("f7-navbar",{attrs:{title:"蓝牙连接"}},[n("f7-nav-right",[n("f7-link",{attrs:{"popup-close":""}},[t._v("x")])],1)],1),t._v(" "),n("f7-block",[n("f7-list",{attrs:{form:""}},[n("f7-list-item",{attrs:{title:"打开蓝牙"}},[n("f7-toggle",{attrs:{slot:"after",checked:t.enableBluetooth},on:{change:t.turnOnOrOffBluetooth},slot:"after"})],1)],1),t._v(" "),n("div",{staticClass:"block-title"},[t._v("已配对的设备")]),t._v(" "),n("div",{staticClass:"list"},[n("ul",[t._l(t.pairedDevices,function(e,a){return n("li",{key:a},[n("a",{staticClass:"item-link item-content",attrs:{href:"#"},on:{click:function(n){t.connDevice(e)}}},[n("div",{staticClass:"item-media"},[t.connectingDevice===e?n("i",{staticClass:"fa fa-spinner fa-spin fa-2x text-color-blue",attrs:{"aria-hidden":"true"}}):n("i",{staticClass:"fa fa-bluetooth fa-2x",class:{"text-color-blue":t.connectedDevice&&t.connectedDevice.address===e.address},attrs:{"aria-hidden":"true"}})]),t._v(" "),n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[t._v(t._s(e.name))])])])])}),t._v(" "),0===t.pairedDevices.length?n("li",[n("div",{staticClass:"item-content"},[n("span",[t._v("未获取到已配对的设备")])])]):t._e()],2)]),t._v(" "),n("div",{staticClass:"block-title"},[t._v("新的设备")]),t._v(" "),n("div",{staticClass:"list"},[n("ul",[t._l(t.newDevices,function(e,a){return n("li",{key:a},[n("a",{staticClass:"item-link item-content",attrs:{href:"#"},on:{click:function(n){t.connDevice(e)}}},[n("div",{staticClass:"item-media"},[t.connectingDevice===e?n("i",{staticClass:"fa fa-spinner fa-spin fa-2x text-color-blue",attrs:{"aria-hidden":"true"}}):n("i",{staticClass:"fa fa-bluetooth fa-2x",class:{"text-color-blue":t.connectedDevice&&t.connectedDevice.address===e.address},attrs:{"aria-hidden":"true"}})]),t._v(" "),n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[t._v(t._s(e.name))])])])])}),t._v(" "),0===t.newDevices.length?n("li",[n("div",{staticClass:"item-content"},[n("span",[t._v("未发现新的设备")])])]):t._e()],2)]),t._v(" "),t.isFindding?t._e():n("button",{staticClass:"button button-fill button-raised button-round",attrs:{type:"button"},on:{click:t.findDevices}},[n("span",[t._v("搜索蓝牙设备")])]),t._v(" "),t.isFindding?n("button",{staticClass:"button button-fill button-raised button-round",attrs:{type:"button"}},[n("i",{staticClass:"fa fa-spinner fa-spin",attrs:{"aria-hidden":"true"}}),t._v(" \n\t\t\t"),n("span",[t._v("正在搜索...")])]):t._e()],1)],1)},staticRenderFns:[]};var b=n("VU/8")(p,B,!1,function(t){n("TR8H")},"data-v-df31af42",null).exports;function M(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.name=t||"",this.timerId=0,this.isPause=!1,this.isPauseCount=!1,this.currentCount=0,this.repeatCount=1,this.intervalTime=0,this.delayTime=0,this.timingStartFun=null,this.timingFun=null,this.timingEndFun=null,e&&M.timerArr.push(this)}M.timerArr=[],M.prototype.init=function(t){for(var e in t)e in this&&(this[e]=t[e]);return this},M.prototype.start=function(){var t=this;function e(){t.executeStartFun(),t.timerId=setInterval(function(){t.isPause||t.executeFun(),t.isPauseCount&&t.isPause||t.currentCount++,t.currentCount>=t.repeatCount&&(t.clear(),t.executeEndFun())},t.intervalTime)}return this.clear(),t.repeatCount>1?this.delayTime>0?this.timerId=setTimeout(function(){e()},this.delayTime):e():this.timerId=setTimeout(function(){t.executeFun()},this.delayTime),this},M.getTimerByName=function(t){var e=null;return M.timer.every(function(n,a){return!n||n.name!==t||(e=n,!1)}),e},M.prototype.clear=function(){return this.timerId&&(this.repeatCount>1?clearInterval(this.timerId):clearTimeout(this.timerId),this.timerId=0),this.currentCount=0,this},M.prototype.cancel=function(){var t=this;return this.clear(),M.timerArr.every(function(e,n){return e!==t||(M.timerArr.splice(n,1),!1)}),this},M.prototype.pauseTiming=function(){return this.isPause=!0,this},M.prototype.continueTiming=function(){return this.isPause=!1,this},M.prototype.executeStartFun=function(){this.timingStartFun&&this.timingStartFun()},M.prototype.executeFun=function(){this.timingFun&&this.timingFun()},M.prototype.executeEndFun=function(){this.timingEndFun&&this.timingEndFun()};var x=M,C={$el:null,$hRockerBall:null,$vRockerBall:null,maxX:0,maxY:0,isAutoMoveToOrign:!0,sendCommandIntervalId:0,hBallPos:{x:0,y:0},vBallPos:{x:0,y:0},hBallStartPos:{x:0,y:0},vBallStartPos:{x:0,y:0},hEvtLastPos:{x:0,y:0},vEvtLastPos:{x:0,y:0},hEvtStartPos:{x:0,y:0},vEvtStartPos:{x:0,y:0},touchmove:function(t){t.preventDefault();var e=t.target;if(e===C.$hRockerBall||e===C.$vRockerBall){Array.prototype.slice.call(t.touches).forEach(function(t){var e=t.pageX,n=t.pageY;Math.abs(e-C.hEvtLastPos.x)<100&&Math.abs(n-C.hEvtLastPos.y)<100&&(C.hBallPos.y=Math.round(n-C.hEvtStartPos.y+C.hBallStartPos.y),C.hEvtLastPos={x:e,y:n},C.maxX<Math.abs(C.hBallPos.y)&&(C.hBallPos.y=C.maxX*C.hBallPos.y/Math.abs(C.hBallPos.y))),Math.abs(e-C.vEvtLastPos.x)<100&&Math.abs(n-C.vEvtLastPos.y)<100&&(C.vBallPos.x=Math.round(e-C.vEvtStartPos.x+C.vBallStartPos.x),C.vEvtLastPos={x:e,y:n},C.maxY<Math.abs(C.vBallPos.x)&&(C.vBallPos.x=C.maxY*C.vBallPos.x/Math.abs(C.vBallPos.x)))}),C.$setMoveBall()}},$setMoveBall:function(){requestAnimationFrame(function(){C.maxX<Math.abs(C.hBallPos.y)&&(C.hBallPos.y=C.maxX*C.hBallPos.y/Math.abs(C.hBallPos.y)),C.$hRockerBall.style.transform="translate("+C.hBallPos.y+"px,0px)",C.maxY<Math.abs(C.vBallPos.x)&&(C.vBallPos.x=C.maxY*C.vBallPos.x/Math.abs(C.vBallPos.x)),C.$vRockerBall.style.transform="translate(0px,"+-C.vBallPos.x+"px)"})},touchstart:function(t){t.preventDefault();var e=t.target;if(e===C.$hRockerBall||e===C.$vRockerBall){var n=C.$hRockerBall.getBoundingClientRect().left,a=C.$hRockerBall.getBoundingClientRect().top,o=C.$vRockerBall.getBoundingClientRect().left,i=C.$vRockerBall.getBoundingClientRect().top;C.hEvtStartPos={x:0,y:0},C.hEvtLastPos=C.hEvtStartPos,C.vEvtStartPos={x:0,y:0},C.vEvtLastPos={x:1e4,y:1e4},Array.prototype.slice.call(t.touches).forEach(function(t){var e=t.pageX,s=t.pageY;Math.abs(e-n)<100&&Math.abs(s-a)<100&&(C.hEvtStartPos={x:e,y:s},C.hBallStartPos={x:C.hBallPos.x,y:C.hBallPos.y},C.hEvtLastPos=C.hEvtStartPos,C.animation.clearHBallAutoMoveToOrign()),Math.abs(e-o)<100&&Math.abs(s-i)<100&&(C.vEvtStartPos={x:e,y:s},C.vBallStartPos={x:C.vBallPos.x,y:C.vBallPos.y},C.vEvtLastPos=C.vEvtStartPos,C.animation.clearVBallAutoMoveToOrign())}),document.addEventListener("touchmove",C.touchmove,!1),C.$setMoveBall()}},touchend:function(t){t.preventDefault();var e=t.target;e===C.$hRockerBall&&C.animation.hBallAutoMoveToOrign(),e===C.$vRockerBall&&C.animation.vBallAutoMoveToOrign()},init:function(){C.$el=document.getElementById("rocker"),C.$hRockerBall=document.getElementById("hRockerBall"),C.$vRockerBall=document.getElementById("vRockerBall"),document.addEventListener("touchstart",C.touchstart,!1),document.addEventListener("touchend",C.touchend,!1),clearInterval(C.sendCommandIntervalId),C.sendCommandIntervalId=setInterval(function(){!function(){var t=Math.round(254*Math.sqrt(Math.abs(C.vBallPos.x)/C.maxY)),e=Math.round(C.hBallPos.y/C.maxX*60);C.vBallPos.x<0&&(t=-t);T.deg=e,T.speed=t,f.connectedDevice&&f.sendDataFunc("[mc:"+t+"&"+e+"]");T.msg="[mc:"+t+"&"+e+"]"}()},100),C.pressControlBtn.init()},destroyed:function(){document.removeEventListener("touchstart",C.touchstart,!1),document.removeEventListener("touchend",C.touchend,!1),clearInterval(C.sendCommandIntervalId),C.animation.clearHBallAutoMoveToOrign(),C.animation.clearVBallAutoMoveToOrign()},animation:{isHBallAutoMove:!0,isVBallAutoMove:!1,hBallAutoMoveToOrignId:0,vBallAutoMoveToOrignId:0,clearHBallAutoMoveToOrign:function(){C.animation.hBallAutoMoveToOrignId&&cancelAnimationFrame(C.animation.hBallAutoMoveToOrignId)},clearVBallAutoMoveToOrign:function(){C.animation.vBallAutoMoveToOrignId&&cancelAnimationFrame(C.animation.vBallAutoMoveToOrignId)},hBallAutoMoveToOrign:function(){C.animation.isHBallAutoMove&&(C.animation.clearHBallAutoMoveToOrign(),function t(){Math.abs(C.hBallPos.y)<=10?C.hBallPos.y=0:C.hBallPos.y=Math.round(C.hBallPos.y-10*C.hBallPos.y/Math.abs(C.hBallPos.y));C.$setMoveBall();0===C.hBallPos.y?C.animation.clearHBallAutoMoveToOrign():C.hBallAutoMoveToOrignId=requestAnimationFrame(t)}())},vBallAutoMoveToOrign:function(){C.animation.isVBallAutoMove&&(C.animation.clearVBallAutoMoveToOrign(),function t(){Math.abs(C.vBallPos.x)<=10?C.vBallPos.x=0:C.vBallPos.x=Math.round(C.vBallPos.x-10*C.vBallPos.x/Math.abs(C.vBallPos.x));C.$setMoveBall();0===C.vBallPos.x?C.animation.clearVBallAutoMoveToOrign():C.animation.vBallAutoMoveToOrignId=requestAnimationFrame(t)}())}},pressControlBtn:{degLeftBtnTime:new x("degLeftBtn"),degRightBtnTime:new x("degRightBtn"),speedUpBtnTime:new x("speedUpBtn"),speedDownBtnTime:new x("speedDownBtn"),hBallAutoMoveTimeId:0,vBallAutoMoveTimeId:0,init:function(){var t=document.getElementById("degLeftBtn"),e=document.getElementById("degRightBtn"),n=document.getElementById("speedUpBtn"),a=document.getElementById("speedDownBtn");t.addEventListener("touchstart",C.pressControlBtn.pressDegLeftBtn,!1),e.addEventListener("touchstart",C.pressControlBtn.pressDegRightBtn,!1),n.addEventListener("touchstart",C.pressControlBtn.pressSpeedUpBtn,!1),a.addEventListener("touchstart",C.pressControlBtn.pressSpeedDownBtn,!1),t.addEventListener("touchend",C.pressControlBtn.pressEndDegLeftBtn,!1),e.addEventListener("touchend",C.pressControlBtn.pressEndDegRightBtn,!1),n.addEventListener("touchend",C.pressControlBtn.pressEndSpeedUpBtn,!1),a.addEventListener("touchend",C.pressControlBtn.pressEndSpeedDownBtn,!1)},pressDegLeftBtn:function(){clearTimeout(C.pressControlBtn.hBallAutoMoveTimeId),C.animation.clearHBallAutoMoveToOrign(),C.pressControlBtn.degLeftBtnTime.init({currentCount:0,repeatCount:1e6,intervalTime:20,delayTime:300,timingFun:function(){C.hBallPos.y=C.hBallPos.y-6,C.$setMoveBall()}}).start(),C.hBallPos.y=C.hBallPos.y-20,C.$setMoveBall()},pressEndDegLeftBtn:function(){C.pressControlBtn.hBallAutoMoveTimeId=setTimeout(function(){C.animation.hBallAutoMoveToOrign()},300),C.pressControlBtn.degLeftBtnTime.clear()},pressDegRightBtn:function(){clearTimeout(C.pressControlBtn.hBallAutoMoveTimeId),C.animation.clearHBallAutoMoveToOrign(),C.pressControlBtn.degRightBtnTime.init({currentCount:0,repeatCount:1e6,intervalTime:20,delayTime:300,timingFun:function(){C.hBallPos.y=C.hBallPos.y+6,C.$setMoveBall()}}).start(),C.hBallPos.y=C.hBallPos.y+20,C.$setMoveBall()},pressEndDegRightBtn:function(){C.pressControlBtn.hBallAutoMoveTimeId=setTimeout(function(){C.animation.hBallAutoMoveToOrign()},300),C.pressControlBtn.degRightBtnTime.clear()},pressSpeedUpBtn:function(){clearTimeout(C.pressControlBtn.vBallAutoMoveTimeId),C.animation.clearVBallAutoMoveToOrign(),C.pressControlBtn.speedUpBtnTime.init({currentCount:0,repeatCount:1e6,intervalTime:20,delayTime:300,timingFun:function(){C.vBallPos.x=C.vBallPos.x+6,C.$setMoveBall()}}).start(),C.vBallPos.x=C.vBallPos.x+20,C.$setMoveBall()},pressEndSpeedUpBtn:function(){C.pressControlBtn.vBallAutoMoveTimeId=setTimeout(function(){C.animation.vBallAutoMoveToOrign()},300),C.pressControlBtn.speedUpBtnTime.clear()},pressSpeedDownBtn:function(){clearTimeout(C.pressControlBtn.vBallAutoMoveTimeId),C.animation.clearVBallAutoMoveToOrign(),C.pressControlBtn.speedDownBtnTime.init({currentCount:0,repeatCount:1e6,intervalTime:20,delayTime:300,timingFun:function(){C.vBallPos.x=C.vBallPos.x-6,C.$setMoveBall()}}).start(),C.vBallPos.x=C.vBallPos.x-20,C.$setMoveBall()},pressEndSpeedDownBtn:function(){C.pressControlBtn.vBallAutoMoveTimeId=setTimeout(function(){C.animation.vBallAutoMoveToOrign()},300),C.pressControlBtn.speedDownBtnTime.clear()}}},T={autoMoveToOrign:{isHBallAutoMove:!0,isVBallAutoMove:!0},deg:0,speed:0,msg:""};var y={name:"Rocker",data:function(){return T},props:{autoMove:{type:Boolean,default:!0},ballPos:{type:Object,default:function(){return{x:0,y:0,maxX:0,maxY:0}}},beforeClose:{type:Function}},created:function(){C.animation.isHBallAutoMove=this.autoMoveToOrign.isHBallAutoMove,C.animation.isVBallAutoMove=this.autoMoveToOrign.isVBallAutoMove,f.connectedDevice||(T.msg="当前未连接到蓝牙设备"),this.horizontalScreen()},computed:{},watch:{"autoMoveToOrign.isHBallAutoMove":function(){C.animation.isHBallAutoMove=this.autoMoveToOrign.isHBallAutoMove},"autoMoveToOrign.isVBallAutoMove":function(){C.animation.isVBallAutoMove=this.autoMoveToOrign.isVBallAutoMove}},mounted:function(){var t=this,e=document.getElementById("rocker-wrap");e.style.width=window.innerHeight+"px",e.style.height=window.innerWidth+"px",setTimeout(function(){C.init(),C.maxY=Math.round(.45*C.$el.offsetHeight),C.maxX=Math.round(108),t.ballPos.maxX=C.maxX,t.ballPos.maxY=C.maxY},2e3)},methods:{closeRocker:function(){this.beforeClose&&this.beforeClose()},onChangeHBallAutoMoveToggle:function(t){var e=t.target.checked;this.autoMoveToOrign.isHBallAutoMove=e},onChangeVBallAutoMoveToggle:function(t){var e=t.target.checked;this.autoMoveToOrign.isVBallAutoMove=e},horizontalScreen:function(){document.body.style.top="0",document.body.style.left="100%",document.body.style.transformOrigin="0 0",document.body.style.transform="rotateZ(90deg)",document.body.style.width=window.innerHeight+"px",document.body.style.height=window.innerWidth+"px"},clearHorizontalScreen:function(){document.body.style.left="",document.body.style.top="",document.body.style.transformOrigin="",document.body.style.transform="",document.body.style.width="",document.body.style.height=""}},destroyed:function(){C.destroyed(),this.clearHorizontalScreen()}},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"rocker-wrap"}},[n("div",{attrs:{id:"rocker"}},[n("button",{staticClass:"button button-raised button-fill back-btn",attrs:{type:"button"},on:{click:t.closeRocker}},[n("i",{staticClass:"icon icon-back"})]),t._v(" "),n("div",{staticClass:"card control-panel"},[n("div",{staticClass:"control-panel-item"},[n("label",{staticClass:"title"},[t._v("角度自动回归:")]),t._v(" "),n("f7-toggle",{attrs:{slot:"after",checked:t.autoMoveToOrign.isHBallAutoMove},on:{change:t.onChangeHBallAutoMoveToggle},slot:"after"})],1),t._v(" "),n("div",{staticClass:"control-panel-item"},[n("label",{staticClass:"title"},[t._v("速度自动回归:")]),t._v(" "),n("f7-toggle",{attrs:{slot:"after",checked:t.autoMoveToOrign.isVBallAutoMove},on:{change:t.onChangeVBallAutoMoveToggle},slot:"after"})],1)]),t._v(" "),n("div",{staticClass:"card msg-panel"},[n("div",{staticClass:"msg-panel-item"},[n("label",{staticClass:"title"},[t._v("当前速度:")]),t._v(" "),n("span",{staticClass:"msg"},[t._v(t._s(t.speed))])]),t._v(" "),n("div",{staticClass:"msg-panel-item"},[n("label",{staticClass:"title"},[t._v("当前角度:")]),t._v(" "),n("span",{staticClass:"msg"},[t._v(t._s(t.deg))])])]),t._v(" "),t._m(0),t._v(" "),t._m(1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"horizontal"}},[e("div",{staticClass:"control-btn-wrap"},[e("button",{staticClass:"button button-raised button-fill",staticStyle:{"border-radius":"50% 0 0 50%",transform:"translateX(-50%)",left:"20%"},attrs:{id:"degLeftBtn",type:"button"}},[e("i",{staticClass:"fa fa-angle-left fa-2x",attrs:{"aria-hidden":"true"}})]),this._v(" "),e("button",{staticClass:"button button-raised button-fill ",staticStyle:{"border-radius":"0 50% 50% 0",transform:"translateX(-50%)",left:"80%"},attrs:{id:"degRightBtn",type:"button"}},[e("i",{staticClass:"fa fa-angle-right fa-2x",attrs:{"aria-hidden":"true"}})])]),this._v(" "),e("div",{staticClass:"track"}),this._v(" "),e("div",{staticClass:"rocker-ball",attrs:{id:"hRockerBall"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"vertical"}},[e("div",{staticClass:"control-btn-wrap"},[e("button",{staticClass:"button button-raised button-fill",staticStyle:{"border-radius":"50% 0 0 50%",transform:"rotateZ(90deg)  translateY(-50%)",top:"30%"},attrs:{id:"speedUpBtn",type:"button"}},[e("i",{staticClass:"fa fa-angle-left fa-2x",attrs:{"aria-hidden":"true"}})]),this._v(" "),e("button",{staticClass:"button button-raised button-fill",staticStyle:{"border-radius":"0 50% 50% 0",transform:"rotateZ(90deg)  translateY(-50%)",top:"70%"},attrs:{id:"speedDownBtn",type:"button"}},[e("i",{staticClass:"fa fa-angle-right fa-2x",attrs:{"aria-hidden":"true"}})])]),this._v(" "),e("div",{staticClass:"track"}),this._v(" "),e("div",{staticClass:"rocker-ball",attrs:{id:"vRockerBall"}})])}]};var _=0,D=0,P={name:"BluetoothCar",data:function(){return{bluetoothStore:f,carModeOptions:[{label:"未知",value:"0"},{label:"手动遥控",value:"1"},{label:"自动寻迹",value:"2"},{label:"自动避障",value:"3"}],carSetting:{carMode:"0",oldAtTurnMaxDeg:0,oldAtMaxSpeed:0,atTurnMaxDeg:0,atMaxSpeed:0},isShowRocker:!1,msg:""}},created:function(){},watch:{},methods:{closeRocker:function(){this.isShowRocker=!1},openRocker:function(){this.isShowRocker=!0},onChageCarMode:function(t){var e=this,n=t.target.value,a=e.carSetting.carMode;e.carSetting.carMode=n;var o="[cm:"+this.carSetting.carMode+"]";this.sendDataToSinglechip(o,!0).then(function(){e.carSetting.carMode=n},function(t){e.$f7.toast.create({text:t,position:"center",closeTimeout:3e3}).open(),setTimeout(function(){e.carSetting.carMode=a},300)})},onChangeAtMaxSpeed:function(t){var e=this;e.carSetting.atMaxSpeed=t,e.carSetting.atMaxSpeed!==e.carSetting.oldAtMaxSpeed&&(clearTimeout(D),D=setTimeout(function(){var t="[tms:"+e.carSetting.atMaxSpeed+"]";e.sendDataToSinglechip(t,!0).then(function(){e.carSetting.oldAtMaxSpeed=e.carSetting.atMaxSpeed},function(t){e.$f7.toast.create({text:t,position:"center",closeTimeout:2e3}).open(),e.carSetting.atMaxSpeed=e.carSetting.oldAtMaxSpeed})},1e3))},onChangeAtTurnMaxDeg:function(t){var e=this;e.carSetting.atTurnMaxDeg=t,e.carSetting.atTurnMaxDeg!==e.carSetting.oldAtTurnMaxDeg&&(clearTimeout(_),_=setTimeout(function(){var t="[tmd:"+e.carSetting.atTurnMaxDeg+"]";e.sendDataToSinglechip(t,!0).then(function(){e.carSetting.oldAtTurnMaxDeg=e.carSetting.atTurnMaxDeg},function(t){e.$f7.toast.create({text:t,position:"center",closeTimeout:2e3}).open(),e.carSetting.atTurnMaxDeg=e.carSetting.oldAtTurnMaxDeg})},1e3))},readCarParamFromSinglechip:function(){var t=this;new h.a(function(t,e){if(f.enableBluetooth)if(f.connectedDevice){cxg.bluetoothSerial.sendData(function(){var n="";f.receiveDataCallback=function(e){n+=e,e.indexOf("]")>-1&&(clearTimeout(a),t(n))};var a=setTimeout(function(){e("单片机接收超时")},2e3)},function(t){e(t)},"[r-p:0]")}else e("当前未连接到蓝牙设备");else e("未打开蓝牙")}).then(function(e){console.log("receiveDataStr="+e),t.resolveCommandData(e)},function(e){t.$f7.toast.create({text:e,position:"center",closeTimeout:3e3}).open()})},sendDataToSinglechip:function(t,e){return new h.a(function(n,a){f.enableBluetooth?t?f.connectedDevice?cxg.bluetoothSerial.sendData(function(){if(e)var o=(new Date).getTime(),i=setInterval(function(){(new Date).getTime()-o>2e3&&(clearInterval(i),a("单片机接收超时")),console.log(f.receiveDataStr),f.receiveDataStr==t&&n()},30);else n()},function(t){a(t)},t):a("当前未连接到蓝牙设备"):a("发送内容不能为空"):a("未打开蓝牙")})},syncCarSetting:function(){},resolveCommandData:function(t){var e=t.indexOf("["),n=t.indexOf("]");if(e>-1&&n>-1&&n>e){var a=(t=t.substring(e+1,n)).indexOf(":");if(!(a<=1)){var o=t.substring(0,a),i={},s=void 0,l=void 0;t.substring(a+1).split("&").forEach(function(t,e){var n=t.indexOf("=");n>-1&&(s=t.substring(0,n),l=t.substring(n+1),i[s]=l)}),"r-p"!==o||this.resolveReadParams(i)}}},resolveReadParams:function(t){void 0!==t.cm&&(this.carSetting.carMode=t.cm),void 0!==t.atTMD&&(this.carSetting.atTurnMaxDeg=1*t.atTMD,this.carSetting.oldAtTurnMaxDeg=this.carSetting.atTurnMaxDeg),void 0!==t.atMS&&(this.carSetting.atMaxSpeed=1*t.atMS,this.carSetting.oldAtMaxSpeed=this.carSetting.atMaxSpeed)}},components:{Bluetooth:b,Rocker:n("VU/8")(y,S,!1,function(t){n("bYBR")},"data-v-73fa598b",null).exports}},k={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("f7-page",[t.isShowRocker?t._e():n("f7-navbar",{attrs:{title:"蓝牙小车控制","back-link":"Back"}}),t._v(" "),n("div",{staticClass:"list"},[n("ul",[n("li",[n("a",{staticClass:"item-link item-content popup-open",attrs:{href:"#","data-popup":"#bluetooth"}},[n("div",{staticClass:"item-media"},[n("i",{staticClass:"fa fa-bluetooth fa-2x",class:{"text-color-blue":t.bluetoothStore.connectedDevice},attrs:{"aria-hidden":"true"}})]),t._v(" "),n("div",{staticClass:"item-inner"},[n("div",{staticClass:"item-title"},[t.bluetoothStore.connectedDevice?n("span",[t._v("已连接到 "+t._s(t.bluetoothStore.connectedDevice.name))]):n("span",[t._v("请连接到蓝牙设备")])])])])])])]),t._v(" "),n("f7-block-title",[n("div",{staticClass:"row",staticStyle:{display:"flex","align-items":"center"}},[n("div",{staticClass:"col"},[t._v("设置小车模式")]),t._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("button",{staticClass:"col button button-outline button-raised",staticStyle:{padding:"2px",height:"24px","line-height":"18px",width:"100px",margin:"0"},on:{click:t.readCarParamFromSinglechip}},[n("i",{staticClass:"fa fa-refresh",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t\t同步参数\n\t\t\t\t")])])])]),t._v(" "),n("f7-list",t._l(t.carModeOptions,function(e,a){return n("f7-list-item",{attrs:{radio:"",value:e.value,title:e.label,checked:e.value===t.carSetting.carMode,name:"carMode"},on:{change:t.onChageCarMode}})})),t._v(" "),n("f7-block-title",[t._v("\n\t\t自动寻迹设置\n\t")]),t._v(" "),n("f7-list",[n("f7-list-item",[n("f7-label",[t._v("寻迹最大速度: "+t._s(t.carSetting.atMaxSpeed))]),t._v(" "),n("f7-input",[n("f7-range",{attrs:{min:"0",max:"255",value:t.carSetting.atMaxSpeed,step:"1",label:!0},on:{"range:change":t.onChangeAtMaxSpeed}})],1)],1),t._v(" "),n("f7-list-item",[n("f7-label",[t._v("转弯最大角度: "+t._s(t.carSetting.atTurnMaxDeg))]),t._v(" "),n("f7-input",[n("f7-range",{attrs:{min:"0",max:"60",value:t.carSetting.atTurnMaxDeg,step:"1",label:!0},on:{"range:change":t.onChangeAtTurnMaxDeg}})],1)],1)],1),t._v(" "),n("f7-block-title",[t._v("\n\t\t手动遥控\n\t")]),t._v(" "),n("f7-block",{attrs:{strong:""}},[n("f7-row",{attrs:{tag:"p"}},[n("button",{staticClass:"button button-fill button-raised col",attrs:{type:"button"},on:{click:t.openRocker}},[n("i",{staticClass:"fa fa-car",attrs:{"aria-hidden":"true"}}),t._v("\n\t\t\t\t遥控小车\n\t\t\t")]),t._v(" "),n("div",{staticClass:"col"})])],1),t._v(" "),n("f7-popup",{attrs:{id:"bluetooth"}},[n("f7-view",[n("Bluetooth")],1)],1),t._v(" "),t.isShowRocker?n("Rocker",{attrs:{beforeClose:t.closeRocker}}):t._e()],1)},staticRenderFns:[]};var A=[{path:"/",component:l},{path:"/about/",component:c},{path:"/car/bluetooth/",component:n("VU/8")(P,k,!1,function(t){n("wc7s")},"data-v-2ab6a269",null).exports},{path:"(.*)",component:v}],E={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"color-theme-blue",attrs:{id:"app"}},[e("div",{staticClass:"statusbar-overlay"}),this._v(" "),e("f7-panel",{attrs:{left:""}},[e("f7-navbar",[e("f7-nav-right",[e("f7-link",{attrs:{"icon-if-ios":"f7:menu","icon-if-md":"material:menu","panel-close":""}})],1),this._v(" "),e("f7-nav-title",[this._v("智能小车")])],1),this._v(" "),e("f7-list",[e("f7-list-item",{attrs:{link:"/car/bluetooth/","panel-close":"",title:"蓝牙小车"}}),this._v(" "),e("f7-list-item",{attrs:{link:"/about/","panel-close":"",title:"关于"}})],1)],1),this._v(" "),e("f7-view",{attrs:{id:"main-view",url:"/",main:""}})],1)},staticRenderFns:[]},O=n("VU/8")({},E,!1,null,null,null).exports;a.a.use(i.a,o.a);var w=new a.a({el:"#app",template:"<app/>",framework7:{id:"io.framework7.testapp",name:"Framework7",theme:"md",routes:A},components:{app:O}});document.addEventListener("deviceready",function(){var t=0;document.addEventListener("backbutton",function(){var e=(new Date).getTime();e-t<600?navigator.app.exitApp():(t=e,w.$f7.router.back())},!1)},!1)},TR8H:function(t,e){},XDfE:function(t,e){},XtQa:function(t,e){},bYBR:function(t,e){},mbRB:function(t,e){},wc7s:function(t,e){},"wj+B":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.3777195c8fec92d804c1.js.map